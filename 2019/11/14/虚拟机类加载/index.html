<!DOCTYPE html>
<html lang="cn">
<head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">

<!--ＪQuery-->
<script src="/Module/JQuery/jquery.min.js"></script>

<!--Vue.js-->
<script src="/Module/vue/vue.js"></script>
<!--饿了么Ｕi-->
<link rel="stylesheet" href="/Module/ElementUi/css/index.css">
<script src="/Module/ElementUi/index.js"></script>

<!--highlight-->
<link rel="stylesheet" href="/Module/highlight/css/zenburn.css">
<script src="/Module/highlight/highlight.min.js"></script>

<!--axios-->
<script src="/Module/axios/axios.min.js"></script>

<!--评论-->
<script src="/Module/comment/valine/Valine.min.js"></script>

<!--主题样式-->
<link rel="stylesheet" href="/Module/style.css">

<!--设置页面描述与关键字,封面图片-->

    <meta name="description" content="jvm是一个内存中的虚拟机，jvm的存储就是内存，我们所写的类，常量变量方法都在内存中,对于任意一个类，都能够知道这个类的所有属性和方法，对任意一个对象，都能够调用它任意方法和属性，动态调用对象方法的功能称为反射;     主要工作在class类加载阶段，主要作用是从系统外部获得class二进制数据流，所有的class都是由classloader进行加载的，classloader负责通过将class文件里的二进制数据流装载进系统，然后教给虚拟机进行连接，初始化等操作" />
    <meta name="keywords" content="" />
    <title>虚拟机类加载</title>
    
    <style>
        #content #title {
            background-image: url('/background.jpg');
        }
    </style>
    

</head>
<body>
    <div id="app" v-cloak>
    <div id="content">
        <el-button type="text" id="nav" icon="el-icon-tickets" @click="visible = !visible"></el-button>
<el-dialog :visible.sync="visible"  title="前往">
    <el-input id="searchInput" v-model="input" placeholder="请输入内容"></el-input>
    <div id="searchResult"></div>

    <br>
    <div id="Menu">
      <div class="grid-content bg-purple"><el-button><el-link :underline="false" href="/">首页</el-link></el-button></div>
      <div class="grid-content bg-purple"><el-button><el-link :underline="false" href="/archive/">归档</el-link></el-button></div>
      <div class="grid-content bg-purple"><el-button><el-link :underline="false" href="/about/">关于</el-link></el-button></div>
      <div class="grid-content bg-purple"><el-button><el-link :underline="false" href="/ly/">留言</el-link></el-button></div>
      <div class="grid-content bg-purple"><el-button><el-link :underline="false" href="/categories/">分类</el-link></el-button></div>
      <div class="grid-content bg-purple"><el-button><el-link :underline="false" href="/tages/">标签</el-link></el-button></div>
    </div>

</el-dialog>

<el-link href="#top"  id="toTop" class="show" :underline="false" icon="el-icon-top" ></el-link>



        
        <div id="title">
            <h1>
                虚拟机类加载<br>
                
                <p>作者：wz<br>编写：2019-11-14</p>
            </h1>
        </div>
        

        <div id="article">
            <meta name="referrer" content="no-referrer">

<ul>
<li><h4 id="Java虚拟机"><a href="#Java虚拟机" class="headerlink" title="Java虚拟机"></a>Java虚拟机</h4><p>jvm是一个内存中的虚拟机，jvm的存储就是内存，我们所写的类，常量变量方法都在内存中</p>
</li>
</ul>
<p>  <img src="http://ww3.sinaimg.cn/large/006tNc79ly1g5ioxe7y3xj30qb0a4aay.jpg" alt="jvm虚拟机结构"></p>
<ul>
<li>Class Loader：依据特定格式，加载class文件到内存</li>
<li>execution engine：对命令进行解析</li>
<li>native interface：融合不同的开发语言的原生库为Java所用</li>
<li>RuntimeDataArea：Jvm内存空间模型</li>
</ul>
<ul>
<li><h4 id="谈谈反射"><a href="#谈谈反射" class="headerlink" title="谈谈反射"></a>谈谈反射</h4><p>语言描述：</p>
<p>对于任意一个类，都能够知道这个类的所有属性和方法，对任意一个对象，都能够调用它任意方法和属性，动态调用对象方法的功能称为反射</p>
<p>实例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Robot</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sayHi</span><span class="params">(String helloSentence)</span></span>&#123;</span><br><span class="line">        System.out.println(helloSentence + <span class="string">" "</span> + name);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> String <span class="title">throwHello</span><span class="params">(String tag)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Hello "</span> + tag;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">"Hello Robot"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">  Class rc = Class.forName(<span class="string">"com.interview.javabasic.reflect.Robot"</span>);</span><br><span class="line">  Robot r = (Robot) rc.newInstance();</span><br><span class="line">  System.out.println(<span class="string">"Class name is "</span> + rc.getName());</span><br><span class="line">  <span class="comment">//获取私有方法，不可以实现继承和接口的方法</span></span><br><span class="line">  Method getHello = rc.getDeclaredMethod(<span class="string">"throwHello"</span>, String.class);</span><br><span class="line">  <span class="comment">//设置为true才可以获取私有方法</span></span><br><span class="line">  getHello.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">  Object str = getHello.invoke(r, <span class="string">"Bob"</span>);</span><br><span class="line">  System.out.println(<span class="string">"getHello result is "</span> + str);</span><br><span class="line">  <span class="comment">//获取public方法，继承的接口的方法可以获取</span></span><br><span class="line">  Method sayHi = rc.getMethod(<span class="string">"sayHi"</span>, String.class);</span><br><span class="line">  sayHi.invoke(r, <span class="string">"Welcome"</span>);</span><br><span class="line">  Field name = rc.getDeclaredField(<span class="string">"name"</span>);</span><br><span class="line">  name.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">  name.set(r, <span class="string">"Alice"</span>);</span><br><span class="line">  sayHi.invoke(r, <span class="string">"Welcome"</span>);</span><br><span class="line">  System.out.println(System.getProperty(<span class="string">"java.ext.dirs"</span>));</span><br><span class="line">  System.out.println(System.getProperty(<span class="string">"java.class.path"</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><h4 id="类从编译到执行的过程"><a href="#类从编译到执行的过程" class="headerlink" title="类从编译到执行的过程"></a>类从编译到执行的过程</h4><ul>
<li>编译器将Robot.java源文件便以为Robot.class字节码文件</li>
<li>ClassLoader将字节码转换为jvm中的class<robot>对象</robot></li>
<li>JVM利用Class<robot>对象实例化为Robot对象</robot></li>
</ul>
</li>
<li><h4 id="ClassLoad："><a href="#ClassLoad：" class="headerlink" title="ClassLoad："></a>ClassLoad：</h4><ol>
<li><p>简介</p>
<p>主要工作在class类加载阶段，主要作用是从系统外部获得class二进制数据流，所有的class都是由classloader进行加载的，classloader负责通过将class文件里的二进制数据流装载进系统，然后教给虚拟机进行连接，初始化等操作</p>
</li>
<li><p>classLoader的种类：</p>
<ul>
<li><p>BootStrapClassLoader：C++编写，加载核心库Java.*</p>
</li>
<li><p>ExtClassLoader:Java编写，加载扩展库javax.*</p>
</li>
<li><p>AppClassLoader:Java编写，加载程序所在目录java.class.path</p>
</li>
<li><p>自定义ClassLoader：Java编写</p>
<p>继承finalClass:去寻找class文件的</p>
<p>继承defineClass：去定义一个类：</p>
</li>
</ul>
<p><img src="http://ww1.sinaimg.cn/large/006tNc79ly1g5rxxg1pmaj30y40a1wfw.jpg" alt="自定义classLoader"></p>
</li>
</ol>
</li>
</ul>
<ul>
<li><h4 id="类加载器的双亲委派模型"><a href="#类加载器的双亲委派模型" class="headerlink" title="类加载器的双亲委派模型"></a>类加载器的双亲委派模型</h4><p><img src="http://ww2.sinaimg.cn/large/006tNc79ly1g5vkczie5lj30vo0l5197.jpg" alt="image-20190811111111546"></p>
<p>源码分析下：</p>
<p><img src="http://ww3.sinaimg.cn/large/006tNc79ly1g5vkfv3xnij310y036n0g.jpg" alt="image-20190811111357374"></p>
<p><img src="http://ww1.sinaimg.cn/large/006tNc79ly1g5vkgen641j30z20klwsu.jpg" alt="image-20190811111426055"></p>
<p>为什么需要双亲委派模型？</p>
<ol>
<li>避免多份同样的字节码的加载</li>
</ol>
</li>
<li><h4 id="类的加载方式"><a href="#类的加载方式" class="headerlink" title="类的加载方式"></a>类的加载方式</h4><ol>
<li>隐式加载：new</li>
<li>显示加载：loadClass，forName等</li>
<li>LoadClass和forName区别<ul>
<li>都是运行时都能知道该类的属性和方法，对于任意一个对象都能调用他的任意方法和属性</li>
<li>Class.forName得到的class是已经初始化完成的，ClassLoader.loadClass得到的class是还没有链接的（lazy加载，可以加快速度）</li>
<li></li>
</ul>
</li>
</ol>
</li>
<li><h4 id="类装载过程"><a href="#类装载过程" class="headerlink" title="类装载过程"></a>类装载过程</h4><p><img src="http://ww3.sinaimg.cn/large/006tNc79ly1g5vmjrkwkfj317o0h744f.jpg" alt="image-20190811122655757"></p>
<p>总体流程：加载-&gt;验证-&gt;准备-&gt;解析-&gt;初始化-&gt;使用-&gt;卸载</p>
</li>
</ul>
   
            <br>
            <hr><br>
            
                <div id="article-previous">
                    <a href="/2019/11/14/垃圾收集器和内存分配/" data-toggle="tooltip" data-placement="top" title="垃圾收集器和内存分配">&larr; 上一篇</a>
                </div>
                
                
                <div id="article-next">
                    <a href="/2019/11/14/JVM内存区域/" data-toggle="tooltip" data-placement="top" title="JVM内存区域">下一篇 &rarr;</a>
                </div>
            
            <br><br>
            <hr>
        </div>
    </div>

    <div id="comment">
        
        
    <h2>留言</h2>
    <div id="vcomments">
    </div>
    <script>
        var valine = new Valine({
        el: '#vcomments', 
        appId: 'HfM9lGHkjvrCY4Y00sfk4TbY-gzGzoHsz',
        appKey: 'yzGGVla3JWB1CeQ6dIECEGVc',
    
        emojiCDN: 'https://i0.hdslb.com/bfs/emote/', 
        emojiMaps: {
          "tv_doge": "6ea59c827c414b4a2955fe79e0f6fd3dcd515e24.png",
          "tv_亲亲": "a8111ad55953ef5e3be3327ef94eb4a39d535d06.png",
          "tv_偷笑": "bb690d4107620f1c15cff29509db529a73aee261.png",
          "tv_再见": "180129b8ea851044ce71caf55cc8ce44bd4a4fc8.png",
          "tv_冷漠": "b9cbc755c2b3ee43be07ca13de84e5b699a3f101.png",
          "tv_发怒": "34ba3cd204d5b05fec70ce08fa9fa0dd612409ff.png",
          "tv_发财": "34db290afd2963723c6eb3c4560667db7253a21a.png",
          "tv_可爱": "9e55fd9b500ac4b96613539f1ce2f9499e314ed9.png",
          "tv_吐血": "09dd16a7aa59b77baa1155d47484409624470c77.png",
          "tv_呆": "fe1179ebaa191569b0d31cecafe7a2cd1c951c9d.png",
          "tv_呕吐": "9f996894a39e282ccf5e66856af49483f81870f3.png",
          "tv_困": "241ee304e44c0af029adceb294399391e4737ef2.png",
          "tv_坏笑": "1f0b87f731a671079842116e0991c91c2c88645a.png",
          "tv_大佬": "093c1e2c490161aca397afc45573c877cdead616.png",
          "tv_大哭": "23269aeb35f99daee28dda129676f6e9ea87934f.png",
          "tv_委屈": "d04dba7b5465779e9755d2ab6f0a897b9b33bb77.png",
          "tv_害羞": "a37683fb5642fa3ddfc7f4e5525fd13e42a2bdb1.png",
          "tv_尴尬": "7cfa62dafc59798a3d3fb262d421eeeff166cfa4.png",
          "tv_微笑": "70dc5c7b56f93eb61bddba11e28fb1d18fddcd4c.png",
          "tv_思考": "90cf159733e558137ed20aa04d09964436f618a1.png",
          "tv_惊吓": "0d15c7e2ee58e935adc6a7193ee042388adc22af.png",
        }
    })
    </script>

    
    
    
     
    </div>
</div>
    <script src="/Module/main.js"></script>
</body>
</html>